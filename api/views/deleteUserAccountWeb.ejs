<!DOCTYPE html>
<html lang="en">
<head>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title><%- webPage.pageName %></title>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto|Varela+Round">
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css">
        <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
        <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
        <style type="text/css">
            *{margin: 0; padding: 0; box-sizing: border-box; } 
            .login-card-outer {display: flex; align-items: center; justify-content: center; width: 100%; margin: 0 auto; height: 100vh; }
            .login-container {width: 100%; max-width: 1366px; margin: 0 auto; }
            body {background: #c0c0c0;font-family: Raleway, sans-serif;color: #666;}
            .login-card-outer .delete {margin: 20px auto;padding: 40px 60px;max-width: 500px;border-radius: 5px;background: #fff;box-shadow: 1px 1px 1px #666;}
            .login-card-outer .delete input {width: 100%;display: block;box-sizing: border-box;margin: 10px 0;padding: 14px 12px;font-size: 16px;border-radius: 2px;font-family: Raleway, sans-serif;}
            .login-card-outer .delete input[type="text"],.login-card-outer .delete input[type="password"] {border: 1px solid #c0c0c0;transition: 0.2s;}
            .login-card-outer .delete input[type="text"]:hover {border-color: #db2300;outline: none;transition: all 0.2s ease-in-out;}
            .login-card-outer .delete input[type="password"]:hover {border-color: #db2300;outline: none;transition: all 0.2s ease-in-out;}
            .login-card-outer .delete input[type="button"] {border: none;background: #db2300;color: white;font-weight: bold;transition: 0.2s;margin: 20px 0px;}
            .login-card-outer .delete input[type="button"]:hover {background: #db2300;}
            .login-card-outer .delete h2 {margin: 20px 0 0;color: #000000;font-size: 28px;}
            .login-card-outer .delete h2,.login-card-outer .delete p,.login-card-outer .delete a {text-align: center;}
            .login-card-outer .delete a {text-decoration: none;font-size: 0.8em;}
            .login-card-outer .delete a:visited {color: inherit;}
            .login-card-outer .delete a:hover {text-decoration: underline;}
            .modal-confirm {color: #636363;width: 400px;}
            .modal-confirm .modal-content {padding: 20px;border-radius: 5px;border: none;text-align: center;font-size: 14px;}
            .modal-confirm .modal-header {border-bottom: none;   position: relative;}
            .modal-confirm h4 {text-align: center;font-size: 26px;margin: 30px 0 -10px;}
            .modal-confirm .close {position: absolute;top: -5px;right: -2px;}
            .modal-confirm .modal-body {color: #999;}
            .modal-confirm .modal-footer {border: none;text-align: center;		border-radius: 5px;font-size: 13px;padding: 10px 15px 25px;}
            .modal-confirm .modal-footer a {color: #999;}		
            .modal-confirm .icon-box {width: 80px;height: 80px;margin: 0 auto;border-radius: 50%;z-index: 9;text-align: center;border: 3px solid #db2300;}
            .modal-confirm .icon-box i {color: #db2300;font-size: 46px;display: inline-block;margin-top: 13px;}
            .modal-confirm .btn, .modal-confirm .btn:active {color: #fff;border-radius: 4px;background: #60c7c1;text-decoration: none;transition: all 0.4s;line-height: normal;min-width: 120px;border: none;min-height: 40px;border-radius: 3px;margin: 0 5px;}
            .modal-confirm .btn-secondary {background: #c1c1c1;}
            .modal-confirm .btn-secondary:hover, .modal-confirm .btn-secondary:focus {background: #a8a8a8;}
            .modal-confirm .btn-danger {background: #db2300;}
            .modal-confirm .btn-danger:hover, .modal-confirm .btn-danger:focus {background: #db2300;}
            .trigger-btn {display: inline-block;margin: 100px auto;}
            #toaster {display: none;position: fixed;top: 0;width: 100%;background-color: #db2300;color: #fff;padding: 10px 20px;text-align: center;box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);}
            input{padding: 14px;height: 45px;border-radius: 30px !important;line-height: 1.5;border: 1px solid #f5f0ed }
        </style>
    </head>
</head>
<body>
    <div class="login-container">
    <div id="toaster"></div>
    <div class="login-card-outer">
    <form class="delete" action="/api/cv-15021990-delete-user-account-web-link" method="post">
        <p>
            <img src="/backend/dist/img/SketchHaus-logo.svg" alt="" height="80px" width="80px" style="border: 1px solid #db2300; border-radius: 60px;">
        </p>
        <h2>Delete Your Account</h2>
        <input type="text" name="email" id="email" placeholder="Email" />
        <!-- <small id="msg" style="color: red;"></small> -->
        <input type="password" name="Password" id="Password" placeholder="Password" />
        <!-- <small id="msg1" style="color: red;"></small> -->
        <input type="button" id="formSubmitButton" onclick="submitButton()" class="trigger-btn" data-toggle="modal" value="Delete" />
    </form>
    </div>
</div>

    <div id="myModal" class="modal fade">
        <div class="modal-dialog modal-confirm modal-dialog-centered">
            <div class="modal-content ">
                <div class="modal-header flex-column">
                    <div class="icon-box">
                        <i class="material-icons">&#xE5CD;</i>
                    </div>
                    <h4 class="modal-title w-100">Are you sure?</h4>
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                </div>
                <div class="modal-body">
                    <p>Do you really want to delete these records? This process will erase your data permanantally and cannot be restore</p>
                </div>
                <div class="modal-footer justify-content-center">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                    <button type="submit" class="btn btn-danger" data-dismiss="modal"
                        onclick="return clickButton();">Delete</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script>
        function submitButton(){
            var email = document.getElementById('email').value;
            var Password = document.getElementById('Password').value;
            if(Password !== "" && email !== ""){
                document.getElementById('formSubmitButton').setAttribute("href", "#myModal")
            }else{
                document.getElementById('formSubmitButton').setAttribute("href", "")
                var toaster = document.getElementById('toaster');
                    toaster.innerHTML = 'Please Fill Out Fields';
                    toaster.style.display = 'block';
                    setTimeout(function () {
                        toaster.style.display = 'none';
                    }, 3000);
            }
        }

        function clickButton() {
            var email = document.getElementById('email').value;
            var Password = document.getElementById('Password').value;
            $.ajax({
                type: "post",
                url: "/api/cv-15021990-delete-user-account-web-link",
                data: {
                    'email': email,
                    'password': Password,
                },
                cache: false,
                success: function (html) {
                    if (html.message == "User Not Found.") {
                        var toaster = document.getElementById('toaster');
                        toaster.innerHTML = 'User Not Found.';
                        toaster.style.display = 'block';

                        setTimeout(function () {
                            toaster.style.display = 'none';
                        }, 3000);
                    } else if (html.message == 'Invalid password') {
                        var toaster = document.getElementById('toaster');
                        toaster.innerHTML = 'Invalid password';
                        toaster.style.display = 'block';

                        setTimeout(function () {
                            toaster.style.display = 'none';
                        }, 3000);

                    } else if (html.message == 'Account has been deleted') {
                        $("#email").val('');
                        $("#Password").val('');
                        history.pushState("anything", "", "#1");
                        window.onhashchange = function (event) {
                            window.location.hash = "a";
                        };
                        var toaster = document.getElementById('toaster');
                        toaster.innerHTML = 'Account has been deleted';
                        toaster.style.backgroundColor = '#179117';
                        toaster.style.display = 'block';

                        setTimeout(function () {
                            toaster.style.display = 'none';
                            toaster.style.backgroundColor = '#db2300';
                        }, 3000);
                    }
                }
            });
            return false;
        }
    </script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"></script>
</body>
</html>
